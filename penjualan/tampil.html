{% extends 'base.html' %}
{% load humanize %}
{% block content %}
<h2>Riwayat Transaksi Penjualan</h2>

{% for trx in transaksi_list %}
<div style="border:1px solid #ccc; padding:1rem; margin-bottom:1.5rem;">
    <strong>Pelanggan:</strong> {{ trx.pelanggan }}<br>
    <strong>Tanggal:</strong> {{ trx.tanggal|date:"d M Y, H:i" }}<br>
    <strong>Total:</strong> Rp {{ trx.total_transaksi|intcomma }}<br>

    <!-- Tombol Cetak -->
    <div style="margin-top: 0.5rem;">
        <a href="{% url 'kasir_cetak_transaksi' trx.id %}" target="_blank" class="no-print" style="display: inline-block; padding: 0.4rem 0.8rem; background-color: #2ecc71; color: white; text-decoration: none; border-radius: 4px;">
            üñ®Ô∏è Cetak Transaksi
        </a>
    </div>

    <table width="100%" style="margin-top: 1rem;">
        <thead>
            <tr style="background-color:#f5f5f5;">
                <th>Produk</th>
                <th>Jumlah</th>
                <th>Total Harga</th>
            </tr>
        </thead>
        <tbody>
            {% for p in trx.penjualan_set.all %}
            <tr>
                <td>{{ p.produk.nama }}</td>
                <td>{{ p.jumlah }}</td>
                <td>Rp {{ p.total_harga|intcomma }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% empty %}
<p>Tidak ada transaksi.</p>
{% endfor %}

{% endblock %}
